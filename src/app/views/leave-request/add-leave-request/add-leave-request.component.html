<h2>Leave Request Form</h2>
<div class="container">
  <!-- <div class="line"></div> -->
  <form (ngSubmit)="submitBtn()" #leaveForm="ngForm" novalidate>
    <div class="row">
      <div class="col-12 col-md-6">

        <!-- Name -->
        <div class="form-floating mb-4 mt-3" *ngIf="isAdmin">
          <select id="floatingName" class="form-select" name="name" required [(ngModel)]="leaverequest.name"
            #nameRef="ngModel" [class.is-invalid]="nameRef.invalid && leaveForm.submitted">
            <option *ngFor="let name of nameOptions" [value]="name">{{ name }}</option>
          </select>
          <label for="floatingName">Name</label>
          <div class="invalid-feedback">Name is required.</div>
        </div>
        <div class="form-floating mb-4 mt-3" *ngIf="!isAdmin">
          <input id="floatingName" type="text" class="form-control" name="name" [(ngModel)]="leaverequest.name" readonly required />
          <label for="floatingName">Name</label>
        </div>

        <!-- Leave Day -->
        <div class="form-floating mb-4">
          <select id="floatingLeaveDay" class="form-select" name="leave_day" required
            [(ngModel)]="leaverequest.leave_day" #leaveDayRef="ngModel"
            [class.is-invalid]="leaveDayRef.invalid && leaveForm.submitted">
            <option value="FullDay">Full Day</option>
            <option value="HalfDay">Half Day</option>
            <option value="permission">Permission</option>
          </select>
          <label for="floatingLeaveDay">Leave Day</label>
          <div class="invalid-feedback">Leave day is required.</div>
        </div>

        <!-- Leave Type -->
        <div class="form-floating">
          <select id="floatingLeaveType" class="form-select mb-4" name="leave_type" required
            [(ngModel)]="leaverequest.leave_type" #leaveTypeRef="ngModel"
            [class.is-invalid]="leaveTypeRef.invalid && leaveForm.submitted">
            <option value="Sick">Sick Leave</option>
            <option value="Casual">Casual Leave</option>
            <option value="Earned">Earned Leave</option>
          </select>
          <label for="floatingLeaveType">Leave Type</label>
          <div class="invalid-feedback">Leave type is required.</div>
        </div>

        <!-- Start Date -->
        <div class="form-floating mb-4">
          <input type="date" class="form-control" id="floatingStartDate" name="start_date" required
            [(ngModel)]="leaverequest.start_date" #startDateRef="ngModel"
            [class.is-invalid]="startDateRef.invalid && leaveForm.submitted" />
          <label for="floatingStartDate">Start Date</label>
          <div class="invalid-feedback">Start date is required.</div>
        </div>

        <!-- End Date -->
        <div class="form-floating mb-4">
          <input type="date" class="form-control" id="floatingEndDate" name="end_date" [min]="leaverequest.start_date"
            required [(ngModel)]="leaverequest.end_date" #endDateRef="ngModel"
            [class.is-invalid]="endDateRef.invalid && leaveForm.submitted" />
          <label for="floatingEndDate">End Date</label>
          <div class="invalid-feedback">End date is required.</div>
        </div>
      </div>

      <div class="col-12 col-md-6">
        <!-- Leave Reason  --->

        <div class="form-floating mb-4 mt-3">
          <textarea class="form-control" name="leave_reason" required rows="4" placeholder="Enter reason"
            style="height: 100px;" [(ngModel)]="leaverequest.leave_reason" #reasonRef="ngModel"
            [class.is-invalid]="reasonRef.invalid && leaveForm.submitted"></textarea>
          <div class="invalid-feedback">Reason is required.</div>
          <label for="floatingTextarea2">Leave Reason</label>
        </div>



        <!-- No. of Days -->

        <div class="form-floating mb-4">
          <input type="number" class="form-control" id="floatingInput" placeholder="name@example.com" name="no_of_days"
            required [(ngModel)]="leaverequest.no_of_days" #noOfDaysRef="ngModel"
            [class.is-invalid]="noOfDaysRef.invalid && leaveForm.submitted">
          <label for="floatingInput">No of Days</label>
          <div class="invalid-feedback">No. of days is required.</div>
        </div>

        <!-- Medical Document Upload -->
        <!-- Medical Document Upload (shown only if leave > 3 days) -->
        <div *ngIf="isMedicalDocRequired">
          <label for="floatingMedicalDoc"
            style="font-family: inherit;font-size: inherit;line-height: inherit;margin-bottom: 20px;">
            Medical Document
          </label>
          <input type="file" class="form-control" id="floatingMedicalDoc" name="medical_doc" required
            [(ngModel)]="leaverequest.medical_doc" #medicalDocRef="ngModel"
            [class.is-invalid]="medicalDocRef.invalid && leaveForm.submitted" />
          <div class="invalid-feedback">Please upload the medical document.</div>
        </div>

      </div>
    </div>

    <div class="text-center mt-3">
      <button type="submit" class="btn" id="btn-apply">Apply</button>
      <button type="button" class="btn ms-2" id="btn-back" (click)="backBtn()">Back</button>
    </div>
  </form>

  <!-- Toaster -->
  <div *ngIf="visible" class="center-toast">
    <c-toaster>
      <c-toast #toast [autohide]="false" [visible]="visible">
        <c-toast-body>
          {{ message}}
          <div class="mt-3 pt-2 border-top text-end">
            <button [cToastClose]="toast" cButton color="secondary" size="sm" (click)="visible = false">
              Close
            </button>
          </div>
        </c-toast-body>
      </c-toast>
    </c-toaster>
  </div>

  <!-- <div *ngIf="showConfirmToast" class="center-toast mt-4">
    <c-toaster>
      <c-toast #confirmBack [autohide]="false" [visible]="showConfirmToast">
        <c-toast-body>
          Are you sure you want to go back?
          <div class="mt-3 pt-2 border-top text-end d-flex justify-content-end gap-2">
            <button cButton color="danger" size="sm" (click)="proceedBack()">Yes</button>
            <button cButton color="secondary" size="sm" (click)="cancelBack()">No</button>
          </div>
        </c-toast-body>
      </c-toast>
    </c-toaster>
  </div> -->

  <div *ngIf="showConfirmToast" class="center-toast mt-4 p -5" style="padding: 10px;">
  <c-toaster>
    <c-toast #confirmToast [autohide]="false" [visible]="showConfirmToast">
      <c-toast-body class="modal-message">
       <h5>Oops! </h5>
       <span>You have unsaved changes.
       If you cancel now, your changes will be lost.<br>
        Do you want to continue?</span>

        <div class="mt-3 pt-2 border-top text-end d-flex justify-content-end gap-4" id="modal-buttons">
          <button cButton class="btn-leave" size="sm" (click)="proceedBack()">Leave Without Saving</button>
          <button cButton class="btn-stay" size="sm" (click)="cancelBack()">Stay on Page</button>
        </div>
      </c-toast-body>
    </c-toast>
  </c-toaster>
</div>


</div>